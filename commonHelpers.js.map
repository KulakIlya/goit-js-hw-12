{"version":3,"file":"commonHelpers.js","sources":["../src/helpers.js","../src/model.js","../src/view.js","../src/main.js"],"sourcesContent":["export const settings = {\n  currentSearchQuery: '',\n  currentPage: 1,\n  isLastPage: false,\n};\n\nexport const API_KEY = '39057867-f9b54f51581e5f2d5762c62b3';\nexport const BASE_URL = 'https://pixabay.com/api/?';\nexport const PER_PAGE = 40;\n","import axios from 'axios';\nimport iziToast from 'izitoast';\n\nimport { API_KEY, BASE_URL, PER_PAGE, settings } from './helpers';\n\nclass Model {\n  constructor() {}\n\n  async fetchCards(searchQuery, page) {\n    try {\n      const res = await axios.get(BASE_URL, {\n        params: {\n          key: API_KEY,\n          q: searchQuery,\n          per_page: PER_PAGE,\n          page,\n          _image_type: 'photo',\n          _orientation: 'horizontal',\n          _safesearch: true,\n        },\n      });\n\n      if (res.data.totalHits <= page * PER_PAGE && res.data.totalHits) {\n        settings.isLastPage = true;\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n        });\n      }\n      return res.data;\n    } catch (error) {\n      console.error(error.message);\n    }\n  }\n}\n\nexport default new Model();\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nclass View {\n  #searchForm = document.querySelector('.search-form');\n  #cardsList = document.querySelector('.card-list');\n  #loader = document.querySelector('.loader');\n  #loadMoreBtn = document.querySelector('.load-more-btn');\n\n  #simplelightboxInstance = new SimpleLightbox('.card-item a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n\n  constructor() {}\n\n  setSearchFormSubmitListener(callback) {\n    this.#searchForm.addEventListener('submit', callback);\n  }\n\n  setLoadMoreBtnClickListener(callback) {\n    this.#loadMoreBtn.addEventListener('click', callback);\n  }\n\n  renderCards({ hits }) {\n    if (!hits.length)\n      return iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n\n    const markup = this.getMarkup(hits);\n    this.#cardsList.insertAdjacentHTML('beforeend', markup);\n\n    this.#simplelightboxInstance.refresh();\n  }\n\n  getMarkup(data) {\n    return data\n      .map(\n        ({\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) => `<li class=\"card-item\">\n    <a href=${largeImageURL}\n      ><img src=${webformatURL} alt=\"${tags}\" height=\"200\"/>\n      <ul class=\"card-info\">\n        <li>\n          Likes\n          <p>${likes}</p>\n        </li>\n        <li>\n          Views\n          <p>${views}</p>\n        </li>\n        <li>\n          Comments\n          <p>${comments}</p>\n        </li>\n        <li>\n          Downloads\n          <p>${downloads}</p>\n        </li>\n      </ul></a\n    >\n  </li>`\n      )\n      .join('');\n  }\n\n  toggleLoader() {\n    this.#loader.classList.toggle('is-hidden');\n  }\n\n  showLoadMoreBtn() {\n    this.#loadMoreBtn.classList.remove('is-hidden');\n  }\n\n  clearCardsList() {\n    this.#cardsList.innerHTML = '';\n  }\n\n  hideLoadMoreBtn() {\n    this.#loadMoreBtn.classList.add('is-hidden');\n  }\n\n  scrollToNewCards() {\n    const cardItemHeight = document\n      .querySelector('.card-item')\n      .getBoundingClientRect().height;\n\n    window.scrollBy({\n      top: cardItemHeight * 2,\n      behavior: 'smooth',\n    });\n  }\n}\n\nexport default new View();\n","import { settings } from './helpers';\nimport model from './model';\nimport view from './view';\n\nclass Main {\n  constructor() {\n    view.setSearchFormSubmitListener(this.onSearchFormSubmit.bind(this));\n    view.setLoadMoreBtnClickListener(this.onLoadMoreBtnClick);\n  }\n\n  async onSearchFormSubmit(e) {\n    e.preventDefault();\n\n    settings.currentSearchQuery = e.currentTarget.elements.search.value;\n\n    if (!settings.currentSearchQuery.trim()) return;\n\n    settings.currentPage = 1;\n    settings.isLastPage = false;\n\n    e.currentTarget.elements.search.value = '';\n\n    view.clearCardsList();\n    view.toggleLoader();\n    view.hideLoadMoreBtn();\n\n    const data = await model.fetchCards(\n      settings.currentSearchQuery,\n      settings.currentPage\n    );\n\n    view.renderCards(data);\n\n    // this.createObserver();\n\n    if (!settings.isLastPage && data.totalHits) view.showLoadMoreBtn();\n    view.toggleLoader();\n  }\n\n  async onLoadMoreBtnClick() {\n    view.hideLoadMoreBtn();\n    view.toggleLoader();\n\n    const res = await model.fetchCards(\n      settings.currentSearchQuery,\n      ++settings.currentPage\n    );\n\n    view.toggleLoader();\n    view.renderCards(res);\n\n    // this.createObserver();\n\n    view.scrollToNewCards();\n    if (!settings.isLastPage) view.showLoadMoreBtn();\n  }\n\n  createObserver() {\n    const observer = new IntersectionObserver(\n      (entries, observer) => {\n        entries.forEach(item => {\n          if (item.isIntersecting) {\n            this.onLoadMoreBtnClick();\n            observer.disconnect();\n          }\n        });\n      },\n      {\n        root: null,\n        rootMargin: '0px',\n        threshold: 0.2,\n      }\n    );\n    const target = document.querySelector('.card-item:last-of-type');\n    observer.observe(target);\n  }\n}\n\nconst app = new Main();\n"],"names":["settings","API_KEY","BASE_URL","PER_PAGE","Model","searchQuery","page","res","axios","iziToast","error","model","View","__privateAdd","_searchForm","_cardsList","_loader","_loadMoreBtn","_simplelightboxInstance","SimpleLightbox","callback","__privateGet","hits","markup","data","webformatURL","largeImageURL","tags","likes","views","comments","downloads","cardItemHeight","view","Main","observer","entries","item","target"],"mappings":"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"}